--- misc/serf-1.3.9/SConstruct	2021-11-27 16:23:04.177650400 +0100
+++ misc/build/serf-1.3.9/SConstruct	2021-11-27 16:19:45.506171200 +0100
@@ -23,6 +23,7 @@
 import sys
 import os
 import re
+import subprocess
 
 EnsureSConsVersion(2,3,0)
 
@@ -159,7 +160,9 @@
 
 env.Append(BUILDERS = {
     'GenDef' : 
-      Builder(action = sys.executable + ' build/gen_def.py $SOURCES > $TARGET',
+      Builder(action = subprocess.list2cmdline((sys.executable,
+                                                'build/gen_def.py')) +
+              ' $SOURCES > $TARGET',
               suffix='.def', src_suffix='.h')
   })
 
@@ -312,7 +315,7 @@
     env.Append(LIBS=['shell32.lib', 'xml.lib'])
   else:
     apr_libs='libapr-1.lib'
-    apu_libs='libaprutil-1.lib'
+    apu_libs='iapr-util.lib'
 
   env.Append(LIBS=[apr_libs, apu_libs])
   if not env.get('SOURCE_LAYOUT', None):
@@ -322,8 +325,8 @@
     env.Append(LIBPATH=['$APR/LibR','$APU/LibR'],
                CPPPATH=['$APR/include', '$APU/include'])
   else:
-    env.Append(LIBPATH=['$APR/Release','$APU/Release'],
-               CPPPATH=['$APR/include', '$APU/include'])
+    env.Append(LIBPATH=['$APR/lib','$APU/lib'],
+               CPPPATH=['$APR/inc/apr', '$APU/inc/apr-util'])
 
   # zlib
   env.Append(LIBS=['zlib.lib'])
@@ -335,7 +338,7 @@
                LIBPATH=['$ZLIB'])
 
   # openssl
-  env.Append(LIBS=['libeay32.lib', 'ssleay32.lib'])
+  env.Append(LIBS=['libcrypto.lib', 'libssl.lib'])
   if not env.get('SOURCE_LAYOUT', None):
     env.Append(CPPPATH=['$OPENSSL/include/openssl'],
                LIBPATH=['$OPENSSL/lib'])
--- misc/serf-1.3.9/buckets/deflate_buckets.c	2015-09-17 14:46:24.000000000 +0200
+++ misc/build/serf-1.3.9/buckets/deflate_buckets.c	2021-11-27 16:11:45.940068700 +0100
@@ -20,7 +20,7 @@
 
 #include <apr_strings.h>
 
-#include <zlib.h>
+#include <zlib/zlib.h>
 
 /* This conditional isn't defined anywhere yet. */
 #ifdef HAVE_ZUTIL_H
